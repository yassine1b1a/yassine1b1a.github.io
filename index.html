<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mafia Game Manager</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f4f4f4;
            padding: 20px;
        }
        .role-counts {
            margin-bottom: 20px;
            font-size: 18px;
        }
        table {
            width: 80%;
            margin: auto;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid black;
            padding: 10px;
            text-align: center;
        }
        .killed {
            text-decoration: line-through;
            color: red;
        }
        .notification {
            color: red;
            font-weight: bold;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1>Mafia Game Manager</h1>
    <label>Number of Players: <input type="number" id="playerCount" min="1"></label>
    <button onclick="setPlayers()">Set Players</button>
    <button onclick="resetRoles()">Reset Roles</button>
    
    <div class="role-counts" id="roleCounts"></div>
    
    <table>
        <thead>
            <tr>
                <th>Player Name</th>
                <th>Role</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody id="playerList"></tbody>
    </table>
    
    <div class="notification" id="notification"></div>
    
    <script>
        let players = [];
        let roles = ["Mafia", "Doctor", "Thinker", "JudgeXcrazy", "Sheriff", "Hacker", "Citizen"];
        let roleCount = {};
        
        function setPlayers() {
            const playerCount = document.getElementById("playerCount").value;
            players = [];
            document.getElementById("playerList").innerHTML = "";
            for (let i = 0; i < playerCount; i++) {
                addPlayer();
            }
            updateRoleCounts();
        }
        
        function addPlayer() {
            const table = document.getElementById("playerList");
            const row = table.insertRow();
            
            const nameCell = row.insertCell(0);
            const roleCell = row.insertCell(1);
            const actionCell = row.insertCell(2);
            
            const nameInput = document.createElement("input");
            nameInput.type = "text";
            nameCell.appendChild(nameInput);
            
            const roleSelect = document.createElement("select");
            roles.forEach(role => {
                let option = document.createElement("option");
                option.value = role;
                option.textContent = role;
                roleSelect.appendChild(option);
            });
            roleCell.appendChild(roleSelect);
            
            const killButton = document.createElement("button");
            killButton.textContent = "Kill";
            killButton.onclick = function() { killPlayer(row); };
            actionCell.appendChild(killButton);
            
            players.push({ nameInput, roleSelect, killed: false });
            updateRoleCounts();
        }
        
        function updateRoleCounts() {
            roleCount = {};
            players.forEach(player => {
                if (!player.killed) {
                    let role = player.roleSelect.value;
                    roleCount[role] = (roleCount[role] || 0) + 1;
                }
            });
            
            document.getElementById("roleCounts").innerHTML = roles.map(role => `${role}: ${roleCount[role] || 0}`).join(" | ");
            checkGameState();
        }
        
        function killPlayer(row) {
            row.classList.add("killed");
            let index = Array.from(row.parentElement.children).indexOf(row);
            players[index].killed = true;
            updateRoleCounts();
        }
        
        function checkGameState() {
            const mafiaCount = roleCount["Mafia"] || 0;
            const hackerCount = roleCount["Hacker"] || 0;
            let otherRolesSum = Object.keys(roleCount).reduce((sum, role) => role !== "Mafia" && role !== "Hacker" ? sum + roleCount[role] : sum, 0);
            
            if (mafiaCount >= otherRolesSum) {
                document.getElementById("notification").innerText = "Mafia has taken over!";
            } else if (mafiaCount === 0) {
                document.getElementById("notification").innerText = "Citizens win!";
            } else {
                document.getElementById("notification").innerText = "";
            }
        }
        
        function resetRoles() {
            players.forEach(player => {
                player.roleSelect.value = "Citizen";
                player.killed = false;
            });
            document.querySelectorAll(".killed").forEach(row => row.classList.remove("killed"));
            updateRoleCounts();
        }
    </script>
</body>
</html>
